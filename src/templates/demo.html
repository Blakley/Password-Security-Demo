<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Demo</title>

        <!--  -->
        <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/animate.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    </head>

    <body id="body">

        <!-- -->
        <header class="navigation">
            <div class="container">
                <nav class="navbar navbar-expand-lg p-0">
                  <!--  -->
                  <a class="navbar-brand" href="home.html">
                        Demo
                  </a>

                  <!--  -->
                  <div class="collapse navbar-collapse ml-auto">
                      <ul class="navbar-nav ml-auto">
                          <li class="nav-item"><a class="nav-link" href="{{ url_for('home') }}">Home</a></li>
                          <li class="nav-item"><a class="nav-link" href="{{ url_for('learn') }}">Learn</a></li>
                          <li class="nav-item active"><a class="nav-link" href="{{ url_for('demo') }}">Demo</a></li>
                      </ul>
                  </div>
                </nav>
            </div>
        </header>

		<!--  -->
        <section class="page-title bg-1">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="block">
                            <h1 class="animated fadeInUp">Lorem ipsum</h1>
                            <p class="animated fadeInUp">
                                Lorem ipsum dolor sit amet, consectetur adipisicing
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

		<!--  -->
        <section class="login-table section bg-gray">
            <div class="container">
                <div class="tabs text-center">
                    <!--  -->
                    <nav class="tab-list">
                        <a class="tab active" href="#one">Login 1</a>
                        <a class="tab" href="#two">Login 2</a>
                        <a class="tab" href="#three">Login 3</a>
                        <a class="tab" href="#four">Login 4</a>
                        <a class="tab" href="#five">Login 5</a>
                        <a class="tab" href="#six">Login 6</a>
                    </nav>
                
                    <!-- login form #1 -->
                    <div id="one" class="tab-content show">
                        <div class="col-md-0 login-form">
                            <div class="login-item">
                                <div class="login-title">
                                    <p3 class="animated fadeInUp">
                                        My account is <strong>admin@secure.com</strong><br>
                                        I don't mind sharing it because you'll never guess the password
                                    </p3>
                                    <strong class="value animated fadeInUp">Login</strong>

                                    <form id="login-form-1" class="user-login-form form" action="/login_1" method="post" autocomplete="off">                 
                                        <input class="username" type="email" name="username" placeholder="Email" required="required" autocomplete="off" />
                                        <input class="password" type="password" name="password" placeholder="Password" required="required" autocomplete="off" />
                                        <br>
                                        <button class="submit1" type="submit">Sign in</button>
                                    </form>

                                    <p id="status1"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <!-- login form #2 -->
                    <div id="two" class="tab-content">
                        <div class="col-md-0 login-form">
                            <div class="login-item">
                                <div class="login-title">
                                    <p3 class="animated fadeInUp">
                                        I'm never given out my account information<br>
                                        I changed my password and you won't be easily guess it either!
                                    </p3>
                                    <strong class="value animated fadeInUp">Login</strong>

                                    <form id="login-form-2" class="user-login-form form" action="/login_2" method="post" autocomplete="off">                 
                                        <input class="username" type="email" name="username" placeholder="Email" required="required" autocomplete="off" />
                                        <input class="password" type="password" name="password" placeholder="Password" required="required" autocomplete="off" />
                                        <br>
                                        <button class="submit2" type="submit">Sign in</button>
                                    </form>

                                    <p id="status2"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                
                    <!-- login form #3 -->
                    <div id="three" class="tab-content">
                        <div class="col-md-0 login-form">
                            <div class="login-item">
                                
                                <div class="login-title">
                                    <p3 class="animated fadeInUp">
                                        I learned my lesson, only humans can access my website!
                                    </p3>
                                    <strong class="value animated fadeInUp">Login</strong>

                                    <form id="login-form-3" class="user-login-form form" action="/login_3" method="post" autocomplete="off">                 
                                        <input class="username" type="email" name="username" placeholder="Email" required="required" autocomplete="off" />
                                        <input class="password" type="password" name="password" placeholder="Password" required="required" autocomplete="off" />
                                        <br>
                                        <button class="submit3" type="submit">Sign in</button>
                                    </form>

                                    <p id="status3"></p>

                                    <!-- Captcha area -->
                                    <div class="captcha-area" style="display: none;">
                                        <div id="captcha">
                                            <img src="{{ url_for('static', filename='images/captcha/2b827.png') }}" id ="captcha-img" alt="CAPTCHA Image">
                                        </div>
                                        <form action="javascript:void(0);" method="post" id="captcha-form">
                                            <input type="text" id="captcha_input" name="captcha_input" placeholder="Type the text above" required="required">
                                        </form>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- login form #4 -->
                    <div id="four" class="tab-content">
                        <div class="col-md-0 login-form">
                            <div class="login-item">
                                
                                <div class="login-title">
                                    <p3 class="animated fadeInUp">
                                        I implemented a lockout policy and finally am at ease<br>
                                    </p3>
                                    <strong class="value animated fadeInUp">Login</strong>

                                    <form id="login-form-4" class="user-login-form form" action="/login_4" method="post" autocomplete="off">                 
                                        <input class="username" type="email" name="username" placeholder="Email" required="required" autocomplete="off" />
                                        <input class="password" type="password" name="password" placeholder="Password" required="required" autocomplete="off" />
                                        <br>
                                        <button class="submit4" type="submit">Sign in</button>
                                    </form>

                                    <p id="status4"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- login form #5 -->
                    <div id="five" class="tab-content">
                        <div class="col-md-0 login-form">
                            <div class="login-item">
                            
                                <div class="login-title">
                                    <h3 class="animated fadeInUp">Lorem Lorem Lorem Lorem Lorem</h3>
                                    <strong class="value animated fadeInUp">Lorem 5</strong>

                                    <form id="login-form-5" class="user-login-form form" action="/login_5" method="post" autocomplete="off">                 
                                        <input class="username" type="email" name="username" placeholder="Email" required="required" autocomplete="off" />
                                        <input class="password" type="password" name="password" placeholder="Password" required="required" autocomplete="off" />
                                        <br>
                                        <button class="submit5" type="submit">Sign in</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- login form #6 -->
                    <div id="six" class="tab-content">
                        <div class="col-md-0 login-form">
                            <div class="login-item">
                                
                                <div class="login-title">
                                    <h3 class="animated fadeInUp">Lorem Lorem Lorem Lorem Lorem</h3>
                                    <strong class="value animated fadeInUp">Lorem 6</strong>

                                    <form id="login-form-6" class="user-login-form form" action="/login_6" method="post" autocomplete="off">                 
                                        <input class="username" type="email" name="username" placeholder="Email" required="required" autocomplete="off" />
                                        <input class="password" type="password" name="password" placeholder="Password" required="required" autocomplete="off" />
                                        <br>
                                        <button class="submit6" type="submit">Sign in</button>
                                    </form>

                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>
       
		<!--  -->
        <section class="faq section-sm">
            <div class="container">
				<h2 class="text-center">Technical Details & Improvements</h2><br>
                <div class="row">
                    
					<!-- Login form #1 -->
					<div class="col-md-6 mt-4 text-center">
                        <h4>Login form #1</h4>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem sed dolor laboriosam laborum expedita quisquam, perferendis esselaboriosam laborum illoadipisicing inventore voluptatibus.</p>
                    </div>

					<!-- Login form #2 -->
                    <div class="col-md-6 mt-4 text-center">
                        <h4>Login form #2</h4>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem sed dolor laboriosam laborum expedita quisquam, perferendis esse illo inventore voluptatibus.</p>
                    </div>

					<!-- Login form #3 -->
					<div class="col-md-6 mt-4 text-center">
                        <h4>Login form #3</h4>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem sed dolor laboriosam laborum expedita quisquam, perferendis esse illo inventore voluptatibus.</p>
                    </div>

					<!-- Login form #4 -->
                    <div class="col-md-6 mt-4 text-center">
                        <h4>Login form #4</h4>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem sed dolor laboriosam laborum expedita quisquam, perferendis esse illo inventore voluptatibus.</p>
                    </div>

					<!-- Login form #5 -->
                    <div class="col-md-6 mt-4 text-center">
                        <h4>Login form #5</h4>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem sed dolor laboriosam laborum expedita quisquam, perferendis esse illo inventore voluptatibus.</p>
                    </div>

					<!-- Login form #6 -->
                    <div class="col-md-6 mt-4 text-center">
                        <h4>Login form #6</h4>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem sed dolor laboriosam laborum expedita quisquam, perferendis esse illo inventore voluptatibus.</p>
                    </div>
                </div>
            </div>
        </section>

        <!--  -->
        <footer class="footer">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <p class="copyright mb-0">
                          Lorem ipsum dolor sit amet, consectetur adipisicing elit <br>
                          Lorem ipsum <a href="">consectetur adipisicing elit</a>
                        </p>
                    </div>
                </div>
            </div>
        </footer>

        <!-- tab navigation -->
        <script>
            document.querySelectorAll(".tab-list").forEach(function(tabList) {
                tabList.addEventListener("click", function(e) {
                  e.preventDefault();
              
                  document.querySelectorAll(".tab").forEach(function(tab) {
                    tab.classList.remove("active");
                  });
                  document.querySelectorAll(".tab-content").forEach(function(content) {
                    content.classList.remove("show");
                  });
              
                  e.target.classList.add("active");
                  document.querySelector(e.target.getAttribute("href")).classList.add("show");
                });
              });
        </script>

        <!-- -->
        <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
        <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>

        <!-- form submission  -->
        <script>
            $(document).ready(function() {

                // user login submission
                $('.user-login-form').submit(function(event) {
                    event.preventDefault();

                    // extract the number from the form's ID
                    let formNumber = $(this).attr('id').replace('login-form-', '');

                    // trigger captcha for login form 3
                    if (formNumber == 3) {
                        console.log('triggering captcha');
                        $(".captcha-area").show();
                    }

                    // construct the route dynamically
                    let route = '/login_' + formNumber;

                    // update the login status msg
                    $.post(route, $(this).serialize(), function(data) {
                        if (data.message && typeof data.message === 'string') {
                            let statusColor = '#dc3545';

                            // handle incorrect attempt
                            if (data.message == 'correct') {
                                statusColor = '#28a745';
                            }

                            // handle locked acount & blocked ip
                            if (data.message == 'account lockout') {
                                // get redirection url
                                if (data.redirect_url)
                                    window.location.href = data.redirect_url;
                            }

                            // update status element
                            $('#status' + formNumber).text(data.message).css('color', statusColor);
                        }

                    }, 'json');

                    this.reset(); // reset input form
                });

                // captcha submission
                $("#captcha_input").on("keyup", function(event) {
                    if (event.key === "Enter") {
                        event.preventDefault();

                        // extract entered text
                        let entered_text = $(this).val();

                        // extract the filename of the CAPTCHA image
                        let imageUrl = $("#captcha-img").attr("src");
                        let filename = imageUrl.substring(imageUrl.lastIndexOf('/') + 1);

                        // create an object to hold form data
                        let formData = {
                            captcha_input: entered_text,
                            captcha_filename: filename
                        };

                        // submit captcha
                        let route = '/captcha_submit';
                        $.post(route, formData, function(data) {
                            if (data.message && typeof data.message === 'string') {
                                console.log('You entered: ' + data.message);

                                // hide completed captcha
                                $(".captcha-area").hide();
                            }
                        }, 'json');
                        
                        $(this).val(''); // reset input form    
                    }
                });

            });
        </script>
    </body>
</html>
